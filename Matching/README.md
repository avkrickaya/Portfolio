# Matching
## Описание задачи
* разработать алгоритм, который для всех товаров из validation.csv предложит несколько вариантов наиболее похожих товаров из base;
* оценить качество алгоритма по метрике accuracy@5.
## Описание данных
* **base.csv** - анонимизированный набор товаров. Каждый товар представлен как уникальный id (0-base, 1-base, 2-base) и вектор признаков размерностью 72.
* **target.csv** - обучающий датасет. Каждая строчка - один товар, для которого известен уникальный id (0-query, 1-query, …) , вектор признаков И id товара из base.csv, который максимально похож на него (по мнению экспертов).
* **validation.csv** - датасет с товарами (уникальный id и вектор признаков), для которых надо найти наиболее близкие товары из base.csv
* **validation_answer.csv** - правильные ответы к предыдущему файлу.
## Используемые инструмент
Pandas, Faiss, NumPy, Sklearn, Matplotlip, FastAPI
## План работы
1.	Предварительная обработка и ознакомление с данными Загрузить датафремы, провести первичный анализ данных. Наметить план дальнейшей работы с данными. Проверить и устранить наличие пропусков, явных дубликатов. Привести к необходимым типам данных.
2.	Обучение модели Подбор гиперпараметров, обучение и выбор наилучшей модели для тестирования.
3.	Тестирование. Проверка модели на тестовой выборке.
## Описание проекта
1. **Предварительная обработка и ознакомление с данными.**

В результате первичного ознакомления выявлено следующее:
* base содержит 2 918 139 строк  и 72 столбца
* train содержит 100 000 строк и  73 столбца
* valid содержит 100 000 строк и 72 столбца
* valid_answer содержит 100 000 строк и 1 столбец
  
 Данные во всех столбцах содержат данные в виде векторов. Пропусков и дубликатов в данных не обнаружено.
В большинстве столбцов данные имеют нормальное распределение. Исключение составляют столбцы 21, 25, 59 и 65. 


2. **Обучение моделей**
   
Для решения данной задачи будут использованы два алгоритма:
* faiss - отбираем 20 кандидатов
* CatBoostClassifier - отбираем 5 наиболее подходящих.
  
Оценивать качество будем метрикой accuracy@5. На первом этапе модель должна выдавать значение accuracy@5 результат близкий к 0.8. 
Затем на основе 20 отобранных кандидатов создадем новые признаки и целевой, которые в дальнейшем передаются для дальнейшего отбора 5 кандидатов модели CatBoostClassifier.

Гиперпараметры CatBoostClassifier подбираются на небольшом срезе обучающей выборки. И затем обучаем на полном объёме данных разделенных на батчи.

3. Реализация поиска наиболее подходящих позиций для запроса на микросервисе.
