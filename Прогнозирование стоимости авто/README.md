# Прогнозирование стоимости автомобиля
<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Прогноз-продаж-в-интернет-магазине" data-toc-modified-id="Прогноз-продаж-в-интернет-магазине-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Прогноз продаж в интернет-магазине</a></span><ul class="toc-item"><li><span><a href="#Описание-проекта" data-toc-modified-id="Описание-проекта-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Описание проекта</a></span></li><li><span><a href="#Описание-данных" data-toc-modified-id="Описание-данных-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Описание данных</a></span></li><li><span><a href="#Вывод" data-toc-modified-id="Вывод-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Вывод</a></span></li></ul></li></ul></div>



## Описание проекта
Необходимо построить модель для определения рыночной стоимости автомобиля с пробегом. В нашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей.

Заказчику важны:

качество предсказания;
скорость предсказания;
время обучения. 

## Описание данных

Признаки:

Дата скачивания анкеты из базы
Тип автомобильного кузова
Год регистрации автомобиля
Тип коробки передач
Мощность (л. с.)
Модель автомобиля
Пробег (км)
Месяц регистрации автомобиля
Тип топлива
Марка автомобиля
Была машина в ремонте или нет
Дата создания анкеты
Количество фотографий автомобиля
Почтовый индекс владельца анкеты (пользователя)
Дата последней активности пользователя
Целевой признак:

Цена (евро)

## Вывод
В результате исследования было сделано следующее:

1. Проведена предварительная обработка данных: заполнены пропуски, изучены и устранены аномальные выбросы в данных, выделены признаки и целевой признак. Так же была проведена кодировка категориальных признаков. Датафрейм разделен на 3 выборки: обучающую (60%), валидационую(20%) и тестовую(20%)
   
2. Для анализа выбрано 6 моделей:

* LinearRegression
* Lasso
* DecisionTreeRegressor
* RandomForestRegressor
* CatBoostRеgressor
* LightGBM
  
3. В ходе исследования было установлено, что масштабирование признаков для линейных моделей не оказывает влияние на качество. Также эти модели выдали худший показатель RMSE среди всех:

* RMSE LinearRegression - 2832.542229
* RMSE Lasso - 2832.541538
  
4. Модели RandomForestRegressor, CatBootsRegressor и LGBMRegressor имеют диапазон метрики RMSE от 1579 до 1792. Что является хорошим показателем(условием нашей задачи RMSE < 2500).
  
5. CatBootsRegressor несмотря на наилучший показатель метрики RMSE очень долго обучается. Было выялено, что на время обучения данной модели оказывает влияние внутреннее кодирование категориальных признаков. При обучении данной модели на кодированных категориальных признаках RMSE немного улучшается, а вот время обучения сильно уменьшается:
* RMSE на не кодированныч данных - 1601.685151
* Время обучения на не кодированных категориальных признаках - 94.498470 секунд
* RMSE на кодированных данных - 1596.682533
* Время обучения на кодированных категориальных признаках - 20.915456 секунд
  
6. Наиболее подходящей моделью по требованиям заказчика(качество предсказания, время обучения и время предсказания модели) является LightGBM:
* качество предсказания(RMSE) - 1656.982036
* время обучения модели - 0.367725 сек.
* время предсказания модели - 0.050491 сек.

